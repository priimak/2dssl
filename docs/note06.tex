\documentclass[40pt,letterpaper,physrev]{article}
\usepackage[utf8]{inputenc}
\usepackage{float}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{cancel}
\usepackage{times} % set times font
\usepackage{color}
\usepackage{datetime}
\usepackage{fullpage}
\usepackage{tikz}
\usepackage{caption}
\usepackage{url}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.eps} 
\author{Dmitri Priimak}
\title{High-frequency signal amplification in semiconductor super-lattice in cross electric and magnetic fields}
\begin{document}
\bibliographystyle{plain}
\newcommand{\ddx}[2] {
	\frac{\text{d}#1}{\text{d}#2}
}
\newcommand{\ddt}[1] {
	\frac{\text{d}#1}{\text{d}t}
}
\newcommand{\dtwodt}[1] {
	\frac{\text{d}^{2}#1}{\text{d}t^{2}}
}
 \begin{center}
  \underline{High-frequency signal amplification in semiconductor super-lattice in cross electric and magnetic fields}
 \end{center}
  \begin{center}
    \underline{Rev. 17}
  \end{center}
  \section{Introduction}  
  A semiconductor superlattice (SL), first studied by Esaki and Tsu \cite{Esaki:70}, is an artificial periodic
  structure, with periods much larger than possible in the normal crystals. It offers may opportunities for
  industrial applications, most of which have not been realized for variety of reasons. More fruitful were 
  applications were applications of SL to the study of fundamental properties of solids. Crucial property 
  of SL is narrowness of conduction band, often referred as "mini-band", which allows electrons to transit this
  zone several times before experiencing collision with the crystal lattice. This property offered one of the 
  earliest ways to observe, so called "Bloch oscillations" \cite{BLOCH}, which would allow generation of 
  high frequency emf fields. This however did not come to fruition as there are mechanisms that destroy these 
  oscillations, one of which is formation of electron domains [*] as well very small power output of 
  such devices [*].
  
  Another very promising field is in observing reaction of SL to the external a/c emf with very practical 
  possibilities of signal detection and amplification. Non-linearity of energy dispersion relation in the 
  mini-band, exposed to use due to the narrowness of the mini-band, offers many intriguing possibilities for study
  chaos as well as large signal amplification. Several different experiments were already performed 
  \cite{PhysRevB.56.10303}, but almost infinite number of possible configurations presents a challenge and makes 
  it all the more important farther theoretical and numerical investigation. Detailed review of SL theory and
  known analytical solutions can be found in work by A. Wacker \cite{WAC01}.
  
  In out work we look at SL, using semi-classical theory, under action of electric field $E(t)=E_{dc}+E_\omega\cos(\omega t)$ along the 
  superlattice axis and constant perpendicular magnetic field.
  	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{illustrations/SL_CROSS_E_AND_B.pdf}
	  \caption{}
	\end{figure}
  The gist of this configuration is 
  presence of two types of motion of electrons in the SL, cyclotron-like like motion and, what we may call, 
  Bloch oscillation regime, also modified due to the presence of magnetic field.
  This configuration has already been studied in the limiting case of zero temperature 
  \cite{PhysRevLett.103.117401}. We, however, will be looking at non-zero temperature, all the way up to the 
  room temperature.
  
  \section{Analytical treatment}
    We take approach of semi-classical theory based on Boltzmann equation, where, the entirety of quantum 
    mechanical nature of the SL is hidden in electron velocity $\mathbf{v}(\mathbf{k})$, which is a function of $
    \mathbf{k}$, crystal momentum. 
    \begin{equation}\label{eq:boltzmann}
     \frac{\partial f}{\partial t}+
     \frac{e}{\hbar}\left ( \mathbf{E} + \mathbf{v}\times\mathbf{B} \right ) \frac{\partial f}{\partial\mathbf{k}}+
     \mathbf{v}(\mathbf{k})\frac{\partial f}{\partial r} = \left ( \frac{\partial f}{\partial t} \right )_{st}
    \end{equation}
    Where $\left ( \partial f/\partial t \right )_{st}$ is a collision term responsible for relaxation to the
    normal electron density distribution function in the absence of external fields. Here we consider the simplest
    form of this term $(f_0-f)/\tau$. Where $f_0$ is, in general, Fermi distribution, but at finite temperatures
    can be approximated by Boltzmann distribution.
    Since we consider electron density $f$ to be spatially homogeneous, $f$ depends only on $\mathbf{k}$ and 
    Boltzmann equation takes form
    \begin{equation}\label{eq:boltzmann_homo}
     \frac{\partial f}{\partial t}+
     \frac{e}{\hbar}\left ( \mathbf{E} + \mathbf{v}\times\mathbf{B} \right ) \frac{\partial f}{\partial\mathbf{k}}
     = \frac{f_0 - f}{\tau}
    \end{equation}
    Electric field is along x-axis and magnetic field is along z-axis.
    \begin{align}
     \mathbf{E}=&(E,0,0) \\
     \mathbf{B}=&(0,0,B) \\
     \mathbf{v}\times\mathbf{B}=&(v_y B, -v_x B, 0))
    \end{align}
    We now proceed with making variety of substitutions to turn this equation into dimensionless form. First we
    will make following substitution
    \begin{equation}
     t \to \tau t
    \end{equation}
    which gives following form to the Boltzmann equation
    \begin{equation}
     \frac{\partial f}{\partial t}+
     \frac{ed\tau}{\hbar}(E+v_{y}B)\frac{\partial f}{\partial(k_x d)}-
     \frac{ed\tau}{\hbar}v_{x}B\frac{\partial f}{\partial(k_y d)}
     = f_0 - f
    \end{equation}
    where 
    \begin{equation}
     \mathbf{v}=\frac{1}{\hbar}\frac{\partial\varepsilon}{\partial\mathbf{k}}
    \end{equation}
    and $\varepsilon$ is an energy of an electron in the zone, which in tight-binding apporiximation takes form in the first zone
    \begin{equation}
     \varepsilon=\frac{\hbar^2k^2_y}{2m}-\frac{\Delta_{1}}{2}\cos(k_{x}d)\label{eq:energy_unscaled}
    \end{equation}
    therefore
    \begin{align}
     v_x=&\frac{\Delta_{1}d}{2\hbar}\sin(dp_x/h) \\
     v_y=&\frac{\hbar k_y}{m}
    \end{align}
    And Boltzmann equations now takes following form
   \begin{equation}
     \frac{\partial f}{\partial t}+
     \left ( \frac{ed\tau}{\hbar}E+\frac{ed\tau}{m}k_yB \right ) \frac{\partial f}{\partial(k_x d)}-
     \frac{\Delta_{1}ed^2\tau}{2\hbar^2}B\sin(k_{x}d)\frac{\partial f}{\partial(k_y d)}
     = f_0 - f
   \end{equation}
   Now we can define
   \begin{align}
	E_*=&\frac{\hbar}{ed\tau} \\	
	m_x=&\frac{2\hbar^2}{\Delta_1 d^2} \\
   \end{align}
   \begin{equation}
	\boxed{\alpha=m/m_x}\label{eq:alpha_def}
   \end{equation}
   Then, with cyclotron frequency defined as 
   \begin{equation}
	\omega_c=\frac{eB}{\sqrt{mm_x}}
   \end{equation}
   we get following
   \begin{equation}
     \frac{\partial f}{\partial t}+
     \left ( \frac{E}{E_*}+\frac{\omega_{c}\tau}{\sqrt{\alpha}}k_yd \right ) \frac{\partial f}{\partial(k_x d)}-
     \sqrt{\alpha}\omega_c\tau\sin(k_x d)\frac{\partial f}{\partial(k_y d)}
     = f_0 - f
   \end{equation}
   And if we now define
   \begin{align}
       \phi_x=&k_{x}d \\
       \phi_y=&\frac{k_{y}d}{\sqrt{\alpha}} \\
       \tilde{E}=&E/E_*\\
       \tilde{B}=&\omega_{c}\tau
   \end{align}
   Boltzmann equations takes form
   \begin{equation}
   	\boxed{
   	\label{eq:boltzmann_final}
     \frac{\partial f}{\partial t}+
     \left ( \tilde{E}+\tilde{B}\phi_y\right ) \frac{\partial f}{\partial\phi_x}-
     \tilde{B}\sin(\phi_x)\frac{\partial f}{\partial\phi_y}
     = f_0 - f}
   \end{equation}
   Alternatively, if we define Bloch frequency as
   \begin{equation}
	\omega_B=\frac{edE}{\hbar}
   \end{equation}
   it can be written as 
   \begin{equation}
     \frac{\partial f}{\partial t}+
     \left ( \omega_B\tau+\omega_c\tau\phi_y\right ) \frac{\partial f}{\partial\phi_x}-
     \omega_c\tau\sin(\phi_x)\frac{\partial f}{\partial\phi_y}
     = f_0 - f
   \end{equation} 
    Ratio of Bloch and cyclotron oscillation frequencies will be important to us down the road.
    For $f_0$ we use Boltzmann distribution 
    \begin{equation}
        f_0\propto e^{\displaystyle -\frac{\varepsilon}{k_bT}}
    \end{equation}
    which in our variables $\phi_x$ and $\phi_y$ takes form
    \begin{equation}
	f_0=C\exp{\left \{ \mu\cos(\phi_x)-\frac{\mu}{2}\phi^2_y\right \} }
	\end{equation}
	\begin{equation}
	\boxed{\mu=\frac{\Delta_1}{2k_{b}T}}
    \end{equation} 
    Now, constant $C$ must be such that dimensionless norm of $f_0$ is 1. Therefore
    \begin{align}
       \frac{1}{C}=&\frac{d^2}
	{\hbar^2}\int^{+\infty}_{-\infty}\text{d}p_y\int_{p_x\in\text{BZ}}\text{d}p_x
	\exp{\left \{ \mu\cos(\phi_x)-\frac{\mu}{2}\phi^2_y\right \} } \\
	   =&\sqrt{\alpha}\int^{+\infty}_{-\infty}e^{-\mu\phi^2_y/2}\text{d}\phi_y
	   \int^{\pi}_{-\pi}e^{\mu\cos(\phi_x)}\text{d}\phi_x \\
	   =&2\pi I_0(\mu)\sqrt{\frac{2\pi\alpha}{\mu}}
    \end{align}
    Thus, full form of equilibrium distribution is
    \begin{equation}
    \boxed{
	f_0=\frac{1}{2\pi I_0(\mu)}\sqrt{\frac{\mu}{2\pi\alpha}}\exp{\left \{ \mu\cos(\phi_x)-\frac{\mu}{2}\phi^2_y\right \} } }
	\end{equation}
	This way, in total, we have four free parameters defining our system, $\mu$ and $\alpha$ that characterize lattice parameters such as lattice period and band width and temperature, and $\tilde{E}$, $\tilde{B}$ that specify external fields.
	One of the parameters that we will be calculating is drift 
	velocity $v_{dr}$, which we will define like this
	\begin{align}
		v_{dr}=&\frac{2d}{\Delta_1\hbar}\iint
			\frac{\partial\varepsilon}{\partial p_x}f(p_x,p_y)\text{d}p_x\text{d}p_y \\
			=&\sqrt{\alpha}\int^{\pi}_{-\pi}\text{d}\phi_x\int^{+\infty}_{-\infty}\text{d}\phi_y\sin(\phi_x)f(\phi_x,\phi_y)\label{eq:v_dr_generic}
	\end{align}
    When magnetic field is $0$ and $E$ is constant, i.e. $E_{dc}$, analytic 
    solution Boltzmann equation is well known and as well as expression for 
    drift velocity and absorption (see below) \cite{WAC01}
    \begin{align}
	v_{dr}=&\left \{ \sqrt{\alpha}\int^{\pi}_{-\pi}\text{d}\phi_x\int^{+\infty}_{-\infty}\text{d}\phi_y\sin(\phi_x)f_0(\phi_x,\phi_y)\right \}
	\frac{E_{dc}/E_*}{1+(E_{dc}/E_*)^2} \\
	=&\frac{I_1(\mu)}{I_0(\mu)}\frac{E_{dc}/E_*}{1+(E_{dc}/E_*)^2}
    \end{align}
	From which follows that peak value of $v_{dr}$ is at $E_{dc}/E_*=1$ and is 
	\begin{equation}
		v_p=\frac{I_1(\mu)}{2I_0(\mu)}\label{eq:v_peak}
	\end{equation}
	Later, down the road, we will be plotting not $v_{dr}$, but $v_{dr}/v_p$,
	which for dc electric field only take very simple form, known as "Esaki-Tsu" equation
	\begin{equation}
		\frac{v_{dr}}{v_p}=2\frac{E_{dc}/E_*}{1+(E_{dc}/E_*)^2}
	\end{equation}
	In general we will be applying a/c emf in the form 
	\begin{equation}
	\tilde{E}=\tilde{E}_{dc}+\tilde{E}_{\omega}\cos(\omega t)\label{eq:tilde_E_as_a_function_of_time}
	\end{equation}
	and in case when magnetic field is not applied we also have analitic expression for $v_{dr}$, which is known as "Tien-Gordon" equation. Analytic expression, "Taker formulae", is also known for absorption, which we will define like this
	\begin{equation}
	A=\left <\frac{v_{dr}}{v_p}\cos(\omega t) \right >_{t}
	\end{equation}
	In case when magnetic field is appied, however, analytic expression for absorption is not known. And that is the quantity we are most interested in.
	
	Now due to periodicty of $f(\phi_x,\phi_y)$ along $\phi_x$ with 
	period $2\pi$ and additionally 
	$f_0(-\phi_x, \phi_y)=f_0(\phi_x, \phi_y)$, it makes sense 
	for us to expand $f$ and $f_0$ into Fourier series.
	\begin{align}
		f_0=&\sum^\infty_{n=0}a^{(0)}_{n}\text{cos}(n\phi_x)\label{eq:f0_fourier_representation} \\
		f=&\sum^\infty_{n=0}a_{n}\text{cos}(n\phi_x)+
		b_{n}\text{sin}(n\phi_x)\label{eq:f_fourier_representation}
	\end{align}
	where coeffients $a^{(0)}_n$, $a_n$ and $b_n$ in general will depend on $\phi_y$ and last two also on time $t$. Note, that $a_{n<0}\equiv 0$ and $b_{n<1}\equiv 0$. And with the from of $f_0$, as selected above, $a^{(0)}_n$ becomes
	\begin{align}
		a^{(0)}_n=&\frac{\sigma(n)}{\pi}\int^{\pi}_{-\pi}f_0(\phi_x,\phi_y)\cos(n\phi_x)\text{d}\phi_x \\
		=&\frac{\sigma(n)I_n(\mu)}{\pi I_0(\mu)}\sqrt{\frac{\mu}{2\pi\alpha}}\exp{\left \{ -\frac{\mu}{2}\phi^2_y\right \} }
	\end{align}
	where 
	\begin{equation}
		\sigma(n)=
		\begin{cases}
   		1/2 & : n=0 \\
   		1 & : n\ne 1
  		\end{cases}
	\end{equation}
	Norm of $f(\phi_x,\phi_y)$ must always be one, i.e.
	\begin{equation}
		\sqrt{\alpha}\int^{\pi}_{-\pi}\text{d}\phi_x
			\int^{+\infty}_{-\infty}\text{d}\phi_y f(\phi_x,\phi_y)=1
	\end{equation}
	which in fourier representation takes form
	\begin{equation}
	\boxed{
		2\pi\sqrt{\alpha}\int^{+\infty}_{-\infty}a_0(\phi_y)\text{d}
		\phi_y=1}
	\end{equation}
	Once we move on to the numerical calculations this equation can be used to check correctness. And from equation (\ref{eq:v_dr_generic}) it is clear that only $b_1$ will survice. And calculation of $v_{dr}$ is done through following 
	equation
	\begin{align}
		v_{dr}=&\sqrt{\alpha}\int^{+\infty}_{-\infty}\text{d}\phi_{y}\int^{+\pi}_{-\pi}\text{d}\phi_x\sin(\phi_x)b_1(\phi_y)\sin(\phi_y)\\
		=&\pi\sqrt{\alpha}\int^{+\infty}_{-\infty}b_1(\phi_y)\text{d}\phi_y
	\end{align}
	and in view of definition of peak value of $v_{dr}$ in eq. (\ref{eq:v_peak})
	\begin{equation}
	\boxed{
		\frac{v_{dr}}{v_p}=\frac{2I_0(\mu)\pi\sqrt{\alpha}}{I_1(\mu)}
			\int^{+\infty}_{-\infty}b_1(\phi_y)\text{d}\phi_y
			}
	\end{equation}
	In addition to drift velocity along $x$-axis we can look at drift velocity alogn $y$-axis, which we will define like this
	\begin{align}
	v_y=&\frac{2}{\Delta_1}\iint\frac{\partial\varepsilon}{\partial p_y}f(\phi_x,\phi_y)\text{d}p_x\text{d}p_y \\
	=&\int^{\pi}_{-\pi}\text{d}\phi_x\int^{+\infty}_{-\infty} \phi_y f(\phi_x,\phi_y) \text{d}\phi_y \\
	=&2\pi\int^{+\infty}_{-\infty}a_0(\phi_y)\phi_y\text{d}\phi_y
	\end{align}
	However just as with drift velocity along $x$-axis we will be working with ratio of $v_y$ and peak velocity $v_p$.
	\begin{equation}
	\boxed{
	\frac{v_y}{v_p}=\frac{4\pi I_0(\mu)}{I_1(\mu)}\int^{+\infty}_{-\infty}a_0(\phi_y)\phi_y\text{d}\phi_y
	}
	\end{equation}
	This way we accounted for meaning of $a_0$ and $b_1$. Let us now take a look at $a_1$. Effective mass of an electron in the $x$ direction is given by 
	\begin{equation}
		m^{-1}_{x,\mathbf{k}}=\frac{1}{\hbar^2}\frac{\partial^2\varepsilon}{\partial k^2_x}
	\end{equation}
	Negative sign of electron effective mass can serve as an intuitive indicator of such state of the system,
	where a/c signal amplification is possible. Although in more exotic situations amplification may take place
	even with positive sign of electron effective mass. In out calculations, however, we will be working with
	ratio of electron mass to $m_{x,\mathbf{k}}$. And in tight-binding approximation, when 
	energy is defined as (\ref{eq:energy_unscaled}), that takes form
	\begin{align}
	\frac{m}{m_{x,\mathbf{k}}}=&\frac{\Delta_1 d^2m}{2\hbar^2}\cos(k_xd) \\
	=&\alpha\cos(\phi_x)
	\end{align}
	To gather back this value from $f(\phi_x,\phi_y)$ we have to integrate over $\{p_x,p_y\}$ and to maintain dimensionlessness of ratio of these masses, this integration will take form
	\begin{align}
	\frac{m}{m_{x,\mathbf{k}}}=&\alpha^{3/2}\frac{d^2}{\hbar^2}\iint f(\phi_x, \phi_y)\cos(k_{x}d)\text{d}p_x\text{d}p_y \\
	=&\alpha^{3/2}\int^{\pi}_{-\pi}\text{d}\phi_x\int^{+\infty}_{-\infty}\text{d}\phi_y f(\phi_x, \phi_y)\cos(\phi_x) \\
	=&\alpha^{3/2}\int^{\pi}_{-\pi}\text{d}\phi_x\int^{+\infty}_{-\infty}\text{d}\phi_y a_1(\phi_y)\cos(\phi_x)\cos(\phi_x)
	\end{align}
	Finally giving us following
	\begin{equation}
	\boxed{
		\frac{m}{m_{x,\mathbf{k}}}=\pi\alpha^{3/2}\int^{+\infty}_{-\infty} a_1(\phi_y)\text{d}\phi_y
		}
	\end{equation}
	Now using fourier representation of $f(\phi_x,\phi_y)$ and $f_0(\phi_y)$ (equations \ref{eq:f0_fourier_representation}, \ref{eq:f_fourier_representation}) we can rewrite Boltzmann equation (\ref{eq:boltzmann_final}) like this
	\begin{align}
	&\sum_{(n)}\bigg \{ \frac{\partial a_n}{\partial t}\cos(n\phi_x) + \frac{\partial b_n}{\partial t}\sin(n\phi_x) = a^{(0)}_{n}\cos(n\phi_x)-a_n\cos(n\phi_x)-b_n\sin(n\phi_x)+\nonumber \\
	&n(\tilde{E}+\tilde{B}\phi_y)(a_n\sin(n\phi_x)-b_n\cos(n\phi_x))+ \tilde{B}\frac{\partial a_n}{\partial\phi_y}\sin(\phi_x)\cos(n\phi_x) + \tilde{B}\frac{\partial b_n}{\partial\phi_y}\sin(\phi_x)\sin(n\phi_x)\bigg \}
	\end{align}
	In absence of magnetic field there is no mixing of different harmonic, however when $\tilde{B}$ is not $0$ then harmonics will be come mixed due to presence of $\sin(\phi_x)\cos(n\phi_x)$ and $\sin(\phi_x)\sin(n\phi_x)$, since
	\begin{align}
	\sin(\phi_x)\cos(n\phi_x)=&\left \{ \sin((n+1)\phi_x) -\sin((n-1)\phi_x) \right \}/2 \\
	\sin(\phi_x)\sin(n\phi_x)=&\left \{ \cos((n-1)\phi_x) -\cos((n+1)\phi_x) \right \}/2
	\end{align}
	And using this equations, after some manipultion of symbols,
	combining elements with the same harmonics, and noting special treatment of $b_1$ we get
	\begin{align}
		\frac{\partial a_n}{\partial t}=&a^{(0)}_n-a_n-n(\tilde{E}+\tilde{B}\phi_y)b_n+\tilde{B}\left ( \frac{\partial b_{n+1}}{\partial\phi_y}-\frac{\partial b_{n-1}}{\partial\phi_y} \right )\label{eq:a_n_dot} \\
		\frac{\partial b_n}{\partial t}=&-b_n-n(\tilde{E}+\tilde{B}\phi_y)a_n+\tilde{B}\left ( \chi(n)\frac{\partial a_{n-1}}{\partial\phi_y}-\frac{\partial a_{n+1}}{\partial\phi_y} \right ) \label{eq:b_n_dot}
	\end{align}
	where
	\begin{equation}
		\chi(n)=
		\begin{cases}
	   2 & : n= 1 \\
	   1 & : n\ne 1
	  \end{cases}
	\end{equation}
    \section{Correspondence with classical pendilum}
    In the limit where dissipation is absent instead of Boltzmann
    equation we can use semiclassical equations of motion working 
    individual electrons. Such situation corresponds to $\tau=\infty$ and initial shape of $f(\phi_x,\phi_x)$ being delta function. 
    \begin{align}
    	\hbar\frac{\text{d}\mathbf{k}}{\text{d}t}=&e\mathbf{E}+e\mathbf{v}\times\mathbf{B} \\
    	\mathbf{v}(\mathbf{k})=&\frac{1}{\hbar}\frac{\partial\varepsilon}{\partial\mathbf{k}}
    \end{align}
    And in view of specific values of $\mathbf{E}$, $\mathbf{B}$ and $\varepsilon$ that we are using in our problem, these equations transform into following
    \begin{align}
	    \ddt{\phi_x}=&\tilde{E}+\tilde{B}\phi_y \label{eq:semi_classical_phi_x_dot} \\
	    \ddt{\phi_y}=&-\tilde{B}\sin(\phi_x) \label{eq:semi_classical_phi_y_dot}
    \end{align}
    And taking second derivative of (\ref{eq:semi_classical_phi_x_dot}), assuming that $\tilde{E}$ is defined by (\ref{eq:tilde_E_as_a_function_of_time}) we arrive to second order ODE, which correspond to classical externally driven pendilum.
    \begin{equation}
    	\dtwodt{\phi_x}+\tilde{B}^2\sin(\phi_x)=-\omega\tilde{E}_\omega\sin(\omega t)
    \end{equation}
    In general this equation can exibit very complicated behaviour and even chaos, but can be solved in the simplest case when $\tilde{E}_\omega=0$, in which case peroid of oscillation is defined by magnetic field $\tilde{B}$ and electric field $\tilde{E}$, which sets initial velocity of $\phi_x$, i.e. $\ddt{\phi_x}$ at $t=0$, assuming that $\phi_x$ and $\phi_y$ at $t=0$ are also $0$. In case of $E_\omega=0$ we exact correspondence of our system to a classical pendilum, for which 
    we do have conservation of energy.
    \begin{equation}
    \frac{1}{2}\left ( \ddt{\phi_x} \right  )^2+2\tilde{B}^2\sin^2(\phi_x/2)=E_{total}
    \end{equation}
    If we define $E_p=2\tilde{B}^2$, which corresponds to 
    "peak" then when $E_{total}=E_p$ then such pendilum can reach 
    inverted position. When $\phi_x$ and $\phi_y$ are equal zero 
    $E_{total}=\tilde{E}_{dc}^2/2$ and thus for $E_p$ there is 
    corresponding $E_{sx}=2\tilde{B}$, which defines separatrix dividing
    motion of the pendilum between vibrational 
    ( $\tilde{E}_{dc}<E_{sx}$ ) and 
    rotational ( $\tilde{E}_{dc}>E_{sx}$ ).
    When our system gives peak of negative absorption corresponding 
    to the first and second cases we speak of "Cycloron" and 
    "Bloch" resonances respectively. Expresion for frequency 
    $\Omega$ of these natural oscilations is well known and in our 
    variables it takes form
    \begin{alignat}{2}
    \Omega=&\frac{\pi E_{sx}}{4\text{K}(\tilde{E}_{dc}/E_{sx})} &\qquad \text{for} \enskip \tilde{E}_{dc}<E_{sx}\\
    \Omega=&\frac{\pi E_{dc}}{2\text{K}(E_{sx}/\tilde{E}_{dc})}
     &\qquad \text{for} \enskip \tilde{E}_{dc}>E_{sx}
    \end{alignat}
    where $\text{K}(x)$ is a complete elliptic integral of the 
    first kind.
    \section{Numerical solution}
   	Straightforward application of method of finite differences 
   	to (\ref{eq:a_n_dot}) and (\ref{eq:b_n_dot}) leads to either 
   	unstable or i.e. computationally intensive equations. To 
   	combat this problem we am using several methods at once.
	First, we are going to discretize $a_{n}$ and $b_{n}$ along 
	time and $\phi_y$ axes.
	\begin{equation}
		a^{\textstyle t\leftarrow\text{time step}}_{\textstyle n,m\leftarrow \phi_y \text{lattice step}}
	\end{equation}
	and $n$ is "harmonic number". So, here we are going to do some tricky things. We are going to write two forms of equations (\ref{eq:a_n_dot}, \ref{eq:b_n_dot}).
	One using forward differences and one using partial backward differences, i.e. on the right side of equal sign we are going to write partial derivatives at time $t$ while everything else at time $t+1$ and will follow standard procedure of Crank–Nicolson scheme by adding these two, 
	forward and backward differences equations. First, forward differencing scheme
	\begin{align}
	a^{t+1}_{n,m}-a^{t}_{n,m}=&a^{(0)}_{n,m}\Delta t-a^t_{n,m}\Delta t-
	2b^t_{n,m}\mu^t_{n,m}+\nonumber \\
	&+\frac{\alpha B\Delta t}{2\Delta\phi}(b^t_{n+1,m+1}-b^t_{n+1,m-1}-b^t_{n-1,m+1}+b^t_{n-1,m-1}) \label{eq:a_forward}\\
	b^{t+1}_{n,m}-b^{t}_{n,m}=&-b^t_{n,m}\Delta t+2a^{t}_{n,m}\mu^t_{n,m}+\nonumber \\
	&+\frac{\alpha B\Delta t}{2\Delta\phi}(\chi(n)[a^t_{n-1,m+1}-a^t_{n-1,m-1}]-a^t_{n+1,m+1}+a^t_{n+1,m-1}) \label{eq:b_forward}
	\end{align}
	And then partial backward differencing scheme
	\begin{align}	
	a^{t+1}_{n,m}-a^{t}_{n,m}=&a^{(0)}_{n,m}\Delta t-a^{t+1}_{n,m}\Delta t-
	2b^{t+1}_{n,m}\mu^{t+1}_{n,m}+\nonumber \\
	&+\frac{\alpha B\Delta t}{2\Delta\phi}(b^t_{n+1,m+1}-b^t_{n+1,m-1}-b^t_{n-1,m+1}+b^t_{n-1,m-1}) \label{eq:a_backward}\\
	b^{t+1}_{n,m}-b^{t}_{n,m}=&-b^{t+1}_{n,m}\Delta t+2a^{t+1}_{n,m}\mu^{t+1}_{n,m}+\nonumber \\
	&+\frac{\alpha B\Delta t}{2\Delta\phi}(\chi(n)[a^t_{n-1,m+1}-a^t_{n-1,m-1}]-a^t_{n+1,m+1}+a^t_{n+1,m-1}) \label{eq:b_backward}
	\end{align}
	where 
	\begin{align}
	\beta^t_m=&E^t+B^t\phi_y(m) \\
	\mu^t_{n,m}=&n\beta^t_{m}\Delta t
	\end{align}
	And application of Crank–Nicolson scheme leads to
	\begin{align}
	a^{t+1}_{n,m}=\frac{g^t_{n,m}\nu-h^t_{n,m}\mu^{t+1}_{n,m}}{\nu^2+\left(\mu^{t+1}_{n,m}\right)^2}\label{eq:a_t_plus_1}\\
	b^{t+1}_{n,m}=\frac{g^t_{n,m}\mu^{t+1}_{n,m}-h^t_{n,m}\nu}{\nu^2+\left(\mu^{t+1}_{n,m}\right)^2}\label{eq:b_t_plus_1}
	\end{align}
	where 
	\begin{align}
	\nu=&1+\Delta t/2 \\
	\xi=&1-\Delta t/2 
	\end{align}
	\begin{align}
	g^t_{n,m}=&a^t_{n,m}\xi-
		b^t_{n,m}\mu^t_{n,m}+A^t_{n,m}+a^{(0)}_{n,m}\Delta t \\
	h^t_{n,m}=&b^t_{n,m}\xi+a^t_{n,m}\mu^t_{n,m}+
		B^t_{n,m} \\
	A^t_{n,m}=&\frac{\alpha B\Delta t}{2\Delta\phi}(\chi(n)[a^t_{n-1,m+1}-a^t_{n-1,m-1}]-a^t_{n+1,m+1}+a^t_{n+1,m-1}) \\
	B^t_{n,m}=&\frac{\alpha B\Delta t}{2\Delta\phi}(b^t_{n+1,m+1}-b^t_{n+1,m-1}-
		b^t_{n-1,m+1}+b^t_{n-1,m-1})
	\end{align}
	These equation (\ref{eq:a_t_plus_1}, \ref{eq:b_t_plus_1})can be formally written in the form
	\begin{align}
		\mathbf{r}^{t+1}_{n,m}=&\mathbf{T}(\mathbf{r}^t_{n,m};A^t_{n,m},B^t_{n,m}) \label{eq:time_shift} \\
		\mathbf{r}^{t}_{n,m}=&(a^t_{n,m}, b^t_{n,m})
	\end{align}
	Where $\mathbf{T}$ is an operator that allows us to step from time step $t$ to $t+1$, separated by time interval $\Delta t$. Using this operation as is leads to, only, conditionally stable numerical system, because $A^t_{n,m}$ and $B^t_{n,m}$ are taken at time $t$, which means that we have to take time step $dt$ to be very, very small. To make time step much larger without solving implicit equations, to calculate $a^{t+1}_{n,m}$ and $b^{t+1}_{n,m}$ we will utilize variation of leap-frog method, by using two staggered girds.
	\begin{minipage}{\linewidth}
	\makebox[\linewidth]{
	\begin{tikzpicture}[]
		\draw[<-,ultra thick] (0.1,0.2) to [out=60,in=120] (3.9,0.2);
		\draw[<-,ultra thick] (2.1,-0.2) to [out=-70,in=-110] (5.9,-0.2);
		\draw[<-,ultra thick] (4.1,0.2) to [out=60,in=120] (7.9,0.2);
		\draw[<-,ultra thick] (6.1,-0.2) to [out=-70,in=-110] (9.9,-0.2);
		\draw[fill] (0, 0) circle [radius=0.1];
		\draw[fill] (2, 0) circle [radius=0.1];
		\draw[fill] (4, 0) circle [radius=0.1];
		\draw[fill] (6, 0) circle [radius=0.1];
		\draw[fill] (8, 0) circle [radius=0.1];
		\draw[fill] (10, 0) circle [radius=0.1];
		\node [right] at (0.1,0) {t+5/2};
		\node [right] at (2.1,0) {t+2};
		\node [right] at (4.1,0) {t+3/2};
		\node [right] at (6.1,0) {t+1};
		\node [right] at (8.1,0) {t+1/2};
		\node [right] at (10.1,0) {t};	
		\end{tikzpicture}
	}
	\captionof{figure}{}
	\label{fig:time_grid}
	\end{minipage}
	And writing (\ref{eq:time_shift}) in the form
	\begin{align}
		\mathbf{r}^{t+1}_{n,m}=&\mathbf{T}(\mathbf{r}^t_{n,m};A^{t+1/2}_{n,m},B^{t+1/2}_{n,m}) \label{eq:leap_frog_shift_1} \\
		\mathbf{r}^{t+3/2}_{n,m}=&\mathbf{T}(\mathbf{r}^{t+1/2}_{n,m};A^{t+1}_{n,m},B^{t+1}_{n,m}) \label{eq:leap_frog_shift_2}
	\end{align}
	Use of these equations is indicated by lower and upper arrows in fig \ref{fig:time_grid}. To start this system we calculate $\mathbf{r}^{1/2}_{n,m}$ by using eq. (\ref{eq:time_shift}) and then shift to leap-frog method.
    \section{CUDA and CPU code}
    The above described numerical algorithm was implemented in C with OpenMP \cite{OpenMP} and in 
    C CUDA \cite{CUDA,wilt2013cuda} and run on NVidia consumer grade GPGPU GTX680. In this section 
    we look at overall implementation of the code and compare two different approaches.
    \newpage
    \section{Results and Discussion}
    We assume that mini-band width $\Delta_1=60$ meV and SL period $d=6$ nm. Values close to these where engineered
    in the actual experiments. For example, in \cite{PhysRevB.56.10303} SL period is $3.8$ nm. and $\Delta_1=?$. 
    Thus, our values of $\Delta_1$ and $d$ represent middle of the road path easily accessible to the
    experimentalists. However, in our dimensionless form of Boltzmann equation, these parameters are encapsulated
    in parameter $\alpha$ (\ref{eq:alpha_def}), which takes value $\alpha=0.9496$, used throughout this work. 
    
    Looking at equations (\ref{eq:a_n_dot}) and (\ref{eq:b_n_dot}) we can branch out into several different 
    directions based on which of the external parameters $\tilde{B}$, $\tilde{E}_{dc}$ and $\tilde{E}_\omega$ 
    are zeroed and which are not. In this work we consider the most difficult case when all three parameters
    are not zero at non-zero temperature, but we will also look at the case where $\tilde{E}_\omega=0$ where
    correspondence between solutions of Boltzmann equation and classical pendulum can be most easily be seen.
    
    Electron density $f$ in the phase space of $(\phi_x, \phi_y)$ spreads out, starting from Boltzmann
    distribution, under the influence of electric and magnetic fields. Typical evolution of electron density
    looks like this. 
    \begin{figure}[H]
   	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.5]{plots/example_of_time_evolution_of_f.pdf}
	  \label{fig:example_of_time_evolution_of_f}
	  \caption{$E_{dc}=7$ $E_\omega=0$ $\mu=11.6$ $\alpha=0.9496$ $B=4$}
	\end{figure}
	Where, you can see initial Boltzmann distribution shown on the frame 0 evolves through the transient 
	processes 1,2,3 and 4 into a final, "eye" like, state seen on frame 6.
	
    Depending on presence or absence
    of a/c emf, $E_\omega$, electron density function reaches either dynamic or static equilibrium. Videos of 
    time evolution of $f(\phi_x,\phi_y)$ for several different initial parameters, with a/c emf turned on, is
    available \footnote{\url{http://youtu.be/PMJSV7SSMlg} \url{http://youtu.be/FKYtk16-rVY}}. When 
    $E_{\omega}=0$, we can easily see clear correspondence between phase portraits of classical pendulum and
    electron density can be easily seen, as on the example below.
    \begin{figure}[H]
   	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.5]{plots/classical_pendulum_phase_portrait_B_is_4_E_dc_is_6_point_5.pdf}
	  \label{fig:classical_and_boltzmann_correspondence_map}
	  \caption{}
	\end{figure}        
    Where $\tilde{B}=4$, $E_{dc}=6.5$ and $\mu=5$. Important feature of these plots is presence, in the phase 
    portrait, of separatrix 
    (shown in red) that separate "cyclotron-like" motion confined within separatrix
    and "Bloch-like" motion that lies outside of separatrix and presence of the same pattern and two distinct
    regions in the portrait electron density on 
    the right. 
    
    In the presence of a/c emf electron density does 
    not reach a static state, but arrives to certain dynamic equilibrium where it "breathes" in or out of sync 
    with external oscillations.
	\newpage
    \section{Additional figures}
	\pagenumbering{gobble}
	\begin{figure}[H]
	  \centering
	  \normalsize
	  \input{plots/v_dr_of_e_dc_B=4_mu=11_dot_6_116}
	  \label{fig:v_dr_of_E_dc_B=4_different_mu}
	  \caption{}
	\end{figure}
	\begin{figure}[H]
	  \centering
	  \normalsize
	  \input{plots/m_over_m_xk_of_e_dc_B=4_mu=11_dot_6_116}
	  \label{fig:effect1ive_mass_of_E_dc_B=4_different_mu}
	  \caption{}
	\end{figure}
	\newpage
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/v_dr_of_e_dc_B=diff}
	  \label{fig:v_dr_of_E_dc_different_B}
	  \caption{}
	\end{figure}
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/m_over_m_xk_of_e_dc_B=diff}
	  \label{fig:effect1ive_mass_of_E_dc_different_B}
	  \caption{}
	\end{figure}
	\newpage	
%	\begin{figure}[t] %
%	  \centering
%	  \normalsize % use normal font size in the figure
%	  \input{combined_B=0_and_4_mu=116_and_1_16_E_omega=0_1}
%	  \label{fig:combined_B=0_and_4_mu=116_and_1_16_E_omega=0_1}
%	  \caption{}
%	\end{figure}		
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/combined_B=4_mu=116_E_omega=0_1_E_dc=6_vs_6_point_4}
	  \label{fig:combined_B=4_mu=116_E_omega=0_1_E_dc=6_vs_6_point_4}
	  \caption{}
	\end{figure}	
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/cycl_vs_bloch_gain}
	  \label{fig:cycl_vs_bloch_gain}
	  \caption{}
	\end{figure}	
	\newpage
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/lorentz_gain}
	  \label{fig:lorentz_gain}
	  \caption{}
	\end{figure}	
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/gain_at_E_dc=6}
	  \label{fig:gain_at_E_dc=6}
	  \caption{}
	\end{figure}
	\newpage
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/vary_omega_B=4_mu=116_E_omega=0_1_E_dc=7_point_8}
	  \label{fig:absorption_ref_E_dc_7_point_8}
	  \caption{}
	\end{figure}	
	
	\newpage	
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/f_of_phi_x_and_time_A=-0_point_038_full}
	  \label{fig:negative_absorption_time_plot}
	  \caption{}
	\end{figure}	
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/f_of_phi_x_and_time_A=-0_point_038_fragment}
	  \label{fig:negative_absorption_time_plot_zoom}
	  \caption{}
	\end{figure}	
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/f_of_phi_x_and_time_A=0_point_02_full}
	  \label{fig:positive_absorption_time_plot}
	  \caption{}
	\end{figure}	
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \input{plots/f_of_phi_x_and_time_A=0_point_02_fragment}
	  \label{fig:positive_absorption_time_plot_zoom}
	  \caption{}
	\end{figure}	
	\newpage	
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/v_dr_and_m_vary_E_dc_and_mu.pdf}
	  \caption{$E_\omega=0.1$, $\omega=2.455$, $B=4$, $\alpha=0.9496$, $\mu=[1.16, 11.6, 116, 216]$}
	  \label{fig:effect_of_temperature_in_v_dr_vary_E_dc_omega=2.455}	  
	\end{figure}	
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/A_and_m_vary_E_dc_and_mu.pdf}
	  \caption{$E_\omega=0.1$, $\omega=2.455$, $B=4$, $\alpha=0.9496$, $\mu=[1.16, 11.6, 116, 216]$}
	  \label{fig:effect_of_temperature_in_A_vary_E_dc_omega=2.455}
	\end{figure}	
	\newpage	
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/v_dr_and_m_vary_E_dc_and_mu_omega=4.pdf}
	  \caption{$E_\omega=0.1$, $\omega=4$, $B=4$, $\alpha=0.9496$, $\mu=[1.16, 11.6, 116, 216]$}
	  \label{fig:effect_of_temperature_in_v_dr_vary_E_dc_omega=4}	  
	\end{figure}	
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/A_and_m_vary_E_dc_and_mu_omega=4.pdf}
	  \caption{$E_\omega=0.1$, $\omega=4$, $B=4$, $\alpha=0.9496$, $\mu=[1.16, 11.6, 116, 216]$}
	  \label{fig:effect_of_temperature_in_A_vary_E_dc_omega=4}
	\end{figure}	
	\newpage	
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/absorption_maps_E_omega_is_0_point_1_mu_is_116_alpha_0_point_0496.pdf}
	  \caption{Maps of absoprtion for $E_\omega=0.1$, $\alpha=0.9496$, $\mu=116$, $\tilde{B}=[1,3,4,8]$ 
	  (plots (a), (b), (c) and (d)) as a function of $\tilde{E}$ (on the x-axis) and $\omega$ (on the y-axis)}
	  \label{fig:absorption}	  
	\end{figure}	
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/B=4_map_and_3_A_and_Asin_plots.pdf}
	  \caption{For map of absorption (a) for $\tilde{B}=4$ we are looking at just the crossections of the
	  map showing absorption $A$ and $ASIN$ components as a functions of $\omega$ at three different values of $E_{dc}$.
	  Plot (b) corresponds to $E_{dc}=6.5$, (c) $E_{dc}=8.2$ and (d) $E_{dc}=9.5$. Line (e) corresponds to $E_{dc}=7.8$, 
	  below you will find figure \ref{fig:E_dc=7.8_B=4_different_mu} that corresponds to this line. Line (f) 
	  corresponds to $E_{dc}=7.0$, below you will find figure \ref{fig:E_dc=7.0_B=4_different_mu} that corresponds to this line.}
	  \label{fig:map_of_absorption_and_profiles_for_three_different_E_dc_B=4}
	\end{figure}	
	\newpage	
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/A_and_ASIN_of_omega_E_dc_is_6_point_5_vary_mu.pdf}
	  \caption{This shows effect of raising temperature on absorption and ASIN as functions of $\omega$ for parameters that 
	  correspond to Fig \ref{fig:map_of_absorption_and_profiles_for_three_different_E_dc_B=4}(b)}
	  \label{fig:E_dc=6.5_B=4_different_mu}	  
	\end{figure}
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/A_and_ASIN_of_omega_E_dc_is_7_point_0_vary_mu.pdf}
	  \caption{This shows effect of raising temperature on absorption and ASIN as functions of $\omega$ for parameters that 
	  correspond to Fig \ref{fig:map_of_absorption_and_profiles_for_three_different_E_dc_B=4}(f)}
	  \label{fig:E_dc=7.0_B=4_different_mu}	  
	\end{figure}
	\newpage
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/A_and_ASIN_of_omega_E_dc_is_7_point_8_vary_mu.pdf}
	  \caption{This shows effect of raising temperature on absorption and ASIN as functions of $\omega$ for parameters that 
	  correspond to Fig \ref{fig:map_of_absorption_and_profiles_for_three_different_E_dc_B=4}(e)}
	  \label{fig:E_dc=7.8_B=4_different_mu}	  
	\end{figure}
	\begin{figure}[H]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/A_and_ASIN_of_omega_E_dc_is_8_point_2_vary_mu.pdf}
	  \caption{This shows effect of raising temperature on absorption and ASIN as functions of $\omega$ for parameters that 
	  correspond to Fig \ref{fig:map_of_absorption_and_profiles_for_three_different_E_dc_B=4}(c)}
	  \label{fig:E_dc=8.2_B=4_different_mu}	  
	\end{figure}
	\newpage
	\begin{figure}[t]
	  \centering
	  \normalsize % use normal font size in the figure
	  \includegraphics[scale=0.7]{plots/A_and_ASIN_of_omega_E_dc_is_9_point_5_vary_mu.pdf}
	  \caption{This shows effect of raising temperature on absorption and ASIN as functions of $\omega$ for parameters that 
	  correspond to Fig \ref{fig:map_of_absorption_and_profiles_for_three_different_E_dc_B=4}(d)}
	  \label{fig:E_dc=9.5_B=4_different_mu}	  
	\end{figure}
	\newpage
	\bibliography{master}
\end{document}
  
